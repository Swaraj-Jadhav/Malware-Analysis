# Static Malware Analysis

Static analysis involves examining the malware's code without executing it. The primary goals of static analysis include:

- **File Structure Examination:** Analyze the file structure to understand the organization of the malware's code.

- **String Analysis:** Extract and review strings within the binary to identify potential indicators of compromise (IoCs).

- **Signature Matching:** Compare the malware's code against a database of known malware signatures to identify it or determine if it is a variant of existing malware.

- **Packing:** Packing is a process of compressing or encrypting the malware to evade a it from pattern based malware analysis systems. 

## Flie Structure Examination

Initially we have two sample files named as **malware-sample-2.zip** and **XMoon.bin.zip**.

![Screenshot (1)](https://github.com/user-attachments/assets/792db0f2-f8fe-4fcf-83b7-2127d1e23186)

When we unzip the XMoon.bin.zip file we get a .bin file. 
Right now we don't know the file type so in this case we are going to use an app known as **HxD**.
Simply drag and drop the .bin file into HxD app we will get an cryptic interface.
Now we are going to look for **MZ, 4D, 5A** and **This program cannot be run in DOS mode** in the code

![Screenshot (2)](https://github.com/user-attachments/assets/b0af155f-5511-40c9-885a-0464e0487448)

Presence of this keywords in a code simply means that this is a executable file (.exe).
It is important to look for such keywords because many times the malware is packed in a differet file format.

## String Analysis

String analysis is the process of analysing of specific strings in a file without actually executing the file.
For string analysis we are going to use **cmder**. Upload the file on cmder and run the command **strings -n 8** this 
command basically returns the all the strings in the file that are greater than 8 words.

![Screenshot (9)](https://github.com/user-attachments/assets/0a4795b3-79e4-4e89-a48f-92e6606c76ad)

Now we have small area to searchfor any irrelevent strings in the program, here we found a string that says **This program cannot be run in DOS mode** as we discussed earlier this keyword implies that the given file is a exe file.

## Signature Matching

Signature matching is the process of comparing the sample code with a database of known malwares signatures to identify if the given sample is malacious. For this we are going to use an website known as **VirusTotal**.Virustotal is known for its extensive database of malware signatures and a large community of vendors and proggrammers, virustotal needs a domain, url or file hash of the sample file so we are going to use HashCalc to get the file hash of our sample and then copy the file hash.

![Screenshot (7)](https://github.com/user-attachments/assets/17837e14-29b0-4bf3-a9cf-3a293fc02597)

A file's hash value is a unique numerical value that identifies the contents of a file. It's generated by applying a cryptographic algorithm to the file's contents. We are simply going to paste the file hash to the virustotal's terminal and it will check for any malicious signatures in the file.

![Screenshot (8)](https://github.com/user-attachments/assets/d5c7c4ef-7003-4447-a89e-bc9921ed6bc2)

## Packing 

A packed malware is a malware that is covered by a protective covering so it is hard for signature matchers to determine  if it is a malware. For this experiment we are going to unzip the second sample file named malware-sample-2.zip. After unzipping its name changes and becomes financials-xls.exe. The file itself is already suspicious because it shows the symbol of an excel file but has an .exe extention. Initially we are going to use an app called **exeinfo** which will look if this file is trying to pack itself.

![Screenshot (12)](https://github.com/user-attachments/assets/bf9140ca-96f7-4f77-9778-0f6ccf695cc5)

After entering the file into exeinfo it gave it various crucial information about the malware like the packing technique(UPX), procedure to decode it, etc. Now that we know the packing techinque the malware is using we can unpack it
using cmder using the command **upx -d -o unpacked.exe financials-xls.exe** this commad will decrypt the malware with respect to upx encryption and give the output in a new file named unpacked.exe

![Screenshot (13)](https://github.com/user-attachments/assets/9ef0d4ce-c897-4d7a-be5a-e91e598b57c7)

Notice that the packed version of the malware was 56Kb but the unpacked version is only 43Kb.
